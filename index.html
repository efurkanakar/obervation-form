<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Observation Form</title>
    <style>
        body {
            font-family: "Gill Sans", sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        .container {
            width: 90%;
            max-width: 1000px;
            min-width: 300px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
            background-color: #e9ecef;
            border-bottom: 1px solid #ccc;
        }

        .section {
            padding: 30px;
            margin: 20px 0;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 12px;
        }

.button.small-button {
    background-color: #28a745;
    color: white;
    padding: 12px 12px;
    font-size: 12px;
    font-weight: normal;
    width: 80px;
    max-width: 80px;
    border-radius: 5px;
    border: 0px solid #28a745;
    transition: background-color 0.2s ease;
}

.button.small-button:hover {
    background-color: #218838;
    border-color: #1e7e34;
}

        .button:hover {
            background-color: #218838;
        }

        .date-observation-row {
            display: flex;
            justify-content: space-between;
            gap: 50px;
        }

        .row {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .input-container {
            flex: 1;
        }

.button-row {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 0px;
}

        .small-input {
            width: 100%;
        }

        .required-star {
            color: red;
        }

.remove-button {
    background-color: #dc3545 !important;
    color: white !important;
    padding: 12px 12px;
    font-size: 12px;
    font-weight: normal;
    width: 80px;
    max-width: 80px;
    border-radius: 5px;
    border: 0px solid #dc3545 !important;
    transition: background-color 0.2s ease;
}

.remove-button:hover {
    background-color: #c82333 !important;
    border-color: #c82333 !important;
}

        .input-container-special {
            flex: 1 1 25%;
            margin-bottom: 20px;
        }

        .input-container-large {
            flex: 1 1 50%;
            margin-bottom: 20px;
        }

        .hidden {
            display: none;
        }

    </style>
    <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("SPZ4gMRCG9sHemlE7"); // API Public Key
        })();

        window.onload = function() {
            var now = new Date();
            var formattedDate = now.toISOString().slice(0, 10); 
            document.getElementById('observation_date').value = formattedDate;

            // Event listeners to show/hide sections based on radio button selection
            document.getElementById('observation_done_yes').addEventListener('change', function() {
                document.getElementById('yes_fields').classList.remove('hidden');
                document.getElementById('no_fields').classList.add('hidden');
            });

            document.getElementById('observation_done_no').addEventListener('change', function() {
                document.getElementById('yes_fields').classList.add('hidden');
                document.getElementById('no_fields').classList.remove('hidden');
            });
        };

        // Add new star fields
        function addStarField() {
            const starContainer = document.getElementById('stars_container');
            const newStarField = document.createElement('div');
            newStarField.classList.add('row');
            newStarField.innerHTML = `
                <div class="input-container-large">
                    <label for="observed_stars">Observed Stars <span class="required-star">*</span></label>
                    <input type="text" name="observed_stars[]" class="small-input" placeholder="Enter star" required>
                </div>

                <div class="input-container-special">
                    <label for="filter">Filter <span class="required-star">*</span></label>
                    <input list="filters" name="filter" required>
                    <datalist id="filters">
                        <option value="SDSS-u'">
                        <option value="SDSS-g'">
                        <option value="SDSS-r'">
                        <option value="SDSS-i'">
                        <option value="SDSS-z'">
                        <option value="Clear">
                        <option value="Bessel-B">
                        <option value="Bessel-V">
                        <option value="Bessel-R">
                        <option value="Bessel-I">
                    </datalist>
                </div>

                <div class="input-container-special">
                    <label for="exposure_time">Exposure Time <span class="required-star">*</span></label>
                    <input list="exposure_times" name="exposure_time" required>
                    <datalist id="exposure_times">
                        <option value="5s">
                        <option value="10s">
                        <option value="20s">
                        <option value="30s">
                        <option value="60s">
                    </datalist>
                </div>

                <div class="input-container-special">
                    <label for="binning">Binning <span class="required-star">*</span></label>
                    <input list="binnings" name="binning" required>
                    <datalist id="binnings">
                        <option value="1x1">
                        <option value="2x2">
                        <option value="3x3">
                        <option value="4x4">
                    </datalist>
                </div>

                <div class="input-container-large">
                    <label for="file_link">Preliminary Result</label>
                    <input type="text" name="file_link[]" class="small-input" placeholder="Paste file link here">
                </div>
            `;
            starContainer.appendChild(newStarField);

            const removeButton = document.getElementById('remove_button');
            removeButton.classList.remove('hidden');
        }

        // Remove last added star field
        function removeLastStarField() {
            const starContainer = document.getElementById('stars_container');
            const starFields = starContainer.getElementsByClassName('row');

            if (starFields.length > 1) {
                starFields[starFields.length - 1].remove();
            }

            if (starFields.length === 1) {
                const removeButton = document.getElementById('remove_button');
                removeButton.classList.add('hidden');
            }
        }
    </script>
</head>
<body>

    <div class="container">
        <h1>Observation Info</h1>

        <div class="section">
            <div class="date-observation-row">
                <div class="date-column">
                    <label for="observation_date">Date</label>
                    <input type="date" id="observation_date" name="observation_date" required>
                </div>

                <div class="observation-column">
                    <label for="observation_done">Was the observation done?</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" id="observation_done_yes" name="observation_done" value="yes" required> Yes
                        </label>
                        <label>
                            <input type="radio" id="observation_done_no" name="observation_done" value="no" required> No
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Yes fields (Hidden by default, will be shown when 'Yes' is selected) -->
        <div id="yes_fields" class="hidden">
            <div class="section">
                <label for="observer_name">Observer Name <span class="required-star">*</span></label>
                <input type="text" id="observer_name" name="observer_name" required placeholder="Enter observer name">

                <div id="stars_container">
                    <div class="row">
                        <div class="input-container-large">
                            <label for="observed_stars">Observed Stars <span class="required-star">*</span></label>
                            <input type="text" name="observed_stars[]" class="small-input" placeholder="Enter star" required>
                        </div>

                        <div class="input-container-special">
                            <label for="filter">Filter <span class="required-star">*</span></label>
                            <input list="filters" name="filter" required>
                            <datalist id="filters">
                                <option value="SDSS-u'">
                                <option value="SDSS-g'">
                                <option value="SDSS-r'">
                                <option value="SDSS-i'">
                                <option value="SDSS-z'">
                                <option value="Clear">
                                <option value="Bessel-B">
                                <option value="Bessel-V">
                                <option value="Bessel-R">
                                <option value="Bessel-I">
                            </datalist>
                        </div>

                        <div class="input-container-special">
                            <label for="exposure_time">Exposure Time <span class="required-star">*</span></label>
                            <input list="exposure_times" name="exposure_time" required>
                            <datalist id="exposure_times">
                                <option value="5s">
                                <option value="10s">
                                <option value="20s">
                                <option value="30s">
                                <option value="60s">
                            </datalist>
                        </div>

                        <div class="input-container-special">
                            <label for="binning">Binning <span class="required-star">*</span></label>
                            <input list="binnings" name="binning" required>
                            <datalist id="binnings">
                                <option value="1x1">
                                <option value="2x2">
                                <option value="3x3">
                                <option value="4x4">
                            </datalist>
                        </div>

                        <div class="input-container-large">
                            <label for="file_link">Preliminary Result</label>
                            <input type="text" name="file_link[]" class="small-input" placeholder="Paste file link here">
                        </div>
                    </div>
                </div>

                <div class="button-row">
                    <button type="button" class="button small-button" onclick="addStarField()">Add</button>
                    <button type="button" class="button small-button remove-button hidden" id="remove_button" onclick="removeLastStarField()">Remove</button>
                </div>

                <div class="input-container">
                    <label for="additional_info">Additional Info</label>
                    <input type="text" id="additional_info" name="additional_info" placeholder="If there is any additional information, please write it here." required>
                </div>
            </div>
        </div>

        <!-- No fields (Hidden by default, will be shown when 'No' is selected) -->
        <div id="no_fields" class="hidden">
            <div class="section">
                <label for="observer_name_no">Observer Name <span class="required-star">*</span></label>
                <input type="text" id="observer_name_no" name="observer_name_no" placeholder="Enter observer name(s)" required>
                <label style="margin-bottom: 15px;">Please select the reason for not doing the observation <span class="required-star">*</span></label>
                <div style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 20px; width: 100%;">
                    <label style="display: flex; align-items: center; gap: 10px; width: 200px;">
                        <input type="checkbox" name="reason_weather" value="Cloudy weather" style="width: auto; margin: 0;">
                        <span>Cloudy Weather</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; width: 200px;">
                        <input type="checkbox" name="reason_wind" value="Strong wind" style="width: auto; margin: 0;">
                        <span>Strong wind</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; width: 200px;">
                        <input type="checkbox" name="reason_humidity" value="High humidity" style="width: auto; margin: 0;">
                        <span>High humidity</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; width: 200px;">
                        <input type="checkbox" name="reason_technical" value="Technical issue" style="width: auto; margin: 0;">
                        <span>Technical issue</span>
                    </label>
                </div>
                <!-- Only the input field for "Other reason" -->
                <input type="text" name="other_reason_text" placeholder="Other reason" style="margin-top: 10px;">

                <div class="input-container">
                    <label for="additional_info">Additional Info</label>
                    <input type="text" id="additional_info" name="additional_info" placeholder="If there is any additional information, please write it here." required>
                </div>
            </div>
        </div>

    </div>

</body>
</html>
